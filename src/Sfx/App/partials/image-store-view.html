<div class="image-store-view">
    <div class="essen-pane ng-scope">
        <div class="table-responsive">
            <table class="essen-table" role="presentation">
                <tbody>
                    <tr>
                        <th>Size of all Applications Packages</th>
                        <th>Count of Application Packages</th>
                    </tr>
                    <tr>
                        <td>{{imagestoreroot.sizeOfAppPackages}}</td>
                        <td>{{imagestoreroot.noOfApplicationPackages}}</td>
                    </tr>
                    <tr>
                        <th>Size of all Application Types</th>
                        <th>Count of Application Types</th>
                    </tr>
                    <tr>
                        <td>{{imagestoreroot.sizeOfAppTypes}}</td>
                        <td>{{imagestoreroot.noOfApplicationTypes}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="explorer-search">        
        <div class="search-bar list-search-bar">
            <input type="search" class="input-flat"
                   autocomplete="off"
                   placeholder="Type folder or file name"
                   ng-model="imageStoreTreeSearchTerm" 
                   ng-keydown="$event.keyCode === 13 && ctrl.search() "/>            
            <a class="search-link" href="" ng-click="ctrl.search()" role="button">Search</a>
            <a class="reset-link" href="" ng-click="ctrl.reset()" role="button">Reset</a>
        </div>        
    </div>
    <div class="header">
        <strong class="header-first-item">Name</strong>
        <strong class="column-item">File version</strong>
        <strong class="column-item">Date modified</strong>
        <strong class="column-item">Size</strong>
        <strong class="column-item">Count of files</strong>
    </div>
    <ul class="complete-list" ng-show="!searchView">
        <li ng-repeat="folder in imagestoreroot.root.childrenFolders" class="list-item" ng-include="'folderTemplate'"></li>
        <li ng-repeat="file in imagestoreroot.root.childrenFiles" class="child list-item" ng-include="'fileTemplate'"></li>
    </ul>

    <ul class="complete-list" ng-show="searchView">
        <div class="bowtie-icon bowtie-spinner loader rotate" ng-show="loader && searchView"></div>
        <li ng-repeat="folder in imagestoreroot.relevantFolders" ng-show="!loader" class="child list-item">
            <span class="indentation list-item-name" padding-left="{{folder.indentationLevel * 16}}px">
                <span class="bowtie-icon bowtie-folder"></span>
                <span class="folder-name-text">{{folder.path}}</span>
            </span>
            <div class="column-item">
                -
            </div>
            <div class="column-item">
                -
            </div>
            <div class="column-item">
                {{folder.displayedSize}}
            </div>
            <div class="column-item">
                {{folder.fileCount}}
            </div>
            <div uib-dropdown class="dropdown" ng-include="'ellipsisFileTemplate'">
            </div>
        </li>
        <li ng-repeat="file in imagestoreroot.relevantFiles" ng-show="!loader" class="child list-item">
            <span class="indentation list-item-name" padding-left="{{file.indentationLevel * 16}}px">
                <span class="bowtie-icon bowtie-file"></span>
                <span class="file-name-text">{{file.path}}</span>
            </span>
            <div class="column-item">
                {{file.version}}
            </div>
            <div class="column-item">
                {{file.modifiedDate}}
            </div>
            <div class="column-item">
                {{file.displayedSize}}
            </div>
            <div class="column-item">
                -
            </div>
            <div uib-dropdown class="dropdown" ng-include="'ellipsisFileTemplate'">
            </div>
        </li>
        <li ng-show="showEmptySearchMessage && !loader" text-align="center">
            There are no folders or files to display.
        </li>
    </ul>

    <script type="text/ng-template" id="ellipsisFileTemplate">
        <a href="" role="button" class="bowtie-icon bowtie-ellipsis dropdown-toggle ellipsis" uib-dropdown-toggle ng-toggle="dropdown">
        </a>
        <ul role="menu" class="dropdown-menu-right" uib-dropdown-menu>
            <li role="menuitem">
                <a href="" role="button" ng-click="ctrl.deleteSelected(file.path)" ng-disabled="file.isReserved" title="System reserved file cannont be deleted.">
                    Delete
                </a>
            </li>
        </ul>
    </script>

    <script type="text/ng-template" id="ellipsisFolderTemplate">
        <a href="" role="button" class="bowtie-icon bowtie-ellipsis dropdown-toggle ellipsis" uib-dropdown-toggle ng-toggle="dropdown">
        </a>
        <ul role="menu" class="dropdown-menu-right" uib-dropdown-menu>
            <li role="menuitem">
                <a href="" role="button" ng-click="ctrl.deleteSelected(folder.path)" ng-disabled="folder.isReserved" title="System reserved folder cannont be deleted.">
                    Delete
                </a>
            </li>
        </ul>
    </script>

    <script type="text/ng-template" id="folderTemplate">
        <div class="child">
            <a href="" role="button" ng-click="ctrl.onFolderClick(folder.path, !folder.isExpanded)" data-open="" class="list-item-name indentation" style="padding-left:{{folder.indentationLevel * 16}}px">                
                <span class="bowtie-icon" ng-class="{ 'bowtie-chevron-down-light': folder.isExpanded, 'bowtie-chevron-right-light': !folder.isExpanded }"></span>
                <span class="bowtie-icon bowtie-folder"></span>                
                <span class="folder-name-text">{{folder.displayName}}</span>                
            </a>
            <div class="column-item">
                -
            </div>
            <div class="column-item">
                -
            </div>
            <div class="column-item">
                {{folder.displayedSize}}
            </div>
            <div class="column-item">
                {{folder.fileCount}}
            </div>
            <div uib-dropdown class="dropdown" ng-include="'ellipsisFolderTemplate'"></div>
        </div>

        <ul class="list-item">
            <li ng-repeat="folder in folder.childrenFolders" ng-include="'folderTemplate'" ng-show="folder.show"></li>        
            <li ng-repeat="file in folder.childrenFiles" ng-include="'fileTemplate'" ng-show="file.show"></li>
        </ul>
    </script>

    <script type="text/ng-template" id="fileTemplate">
        <div class="child">
            <span class="indentation list-item-name" style="padding-left:{{file.indentationLevel * 16}}px">
                <span class="bowtie-icon bowtie-file"></span>                    
                <span class="file-name-text">{{file.displayName}}</span>
            </span>
            <div class="column-item">
                {{file.version}}
            </div>
            <div class="column-item">
                {{file.modifiedDate}}
            </div>
            <div class="column-item">
                {{file.displayedSize}}
            </div>
            <div class="column-item">
                -
            </div>
            <div uib-dropdown class="dropdown" ng-include="'ellipsisFileTemplate'"></div>
        </div>
    </script>
    <div uib-modal-window="modal-window" ng-show="showDeleteConfirmation" class="modal fade ng-scope ng-isolate-scope in" role="dialog" index="0" animate="animate"
        ng-style="{'z-index': 1050 + $$topModalIndex*10, display: 'block'}">
        <form class="ng-pristine ng-valid ng-scope">
            <div class="modal-header">
                <h4 class="modal-title ng-binding">Confirm deletion</h4>
            </div>
            <div class="modal-body">
                <p class="ng-binding">Delete {{confirmationKeyword}}? This action cannot be undone.</p>
                <input class="input-flat ng-pristine ng-untouched ng-valid ng-empty" type="text" placeholder="Type in '{{confirmationKeyword}}' to continue" autocomplete="off"
                    ng-model="usertypedkeyword" aria-hidden="false" aria-invalid="false">
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary ng-binding" data-dismiss="modal" ng-disabled="confirmationKeyword !== usertypedkeyword" ng-click="ctrl.deleteConfirmed()"
                    disabled="disabled">
                    Delete Image Store content
                </button>
                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="usertypedkeyword = null; ctrl.deleteCanceled()">Cancel</button>
            </div>
        </form>
    </div>
</div>