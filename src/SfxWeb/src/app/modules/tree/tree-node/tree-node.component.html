<div *ngIf="node.isExpanded">
    <li *ngFor="let child of node.displayedChildren" class="node" [ngClass]="{ 'selected': child.selected }" >

            <div class="self hide-nested" (click)="child.handleClick()" style="width: 100%" [attr.aria-label]="child.displayName()" *ngIf="child.isVisibleByBadge">
                <span  [ngStyle]="{ 'paddingLeft': child.paddingLeftPx, 'width': ('calc(100% - ' + child.paddingLeftPx.toString() + ')') }"></span>
                    <span tabindex="-1" class="expander icon bowtie-icon" aria-hidden="true"
                            (click)="child.toggle(); $event.stopPropagation()" *ngIf="child.hasExpander"
                            [ngClass]="{ 'bowtie-chevron-right-light': child.isCollapsed, 'bowtie-chevron-down-light': child.isExpanded }"
                            [ngStyle]="{ 'left': (child.paddingLeft - 8) + 'px' }">()
                    </span>
                    <span tabindex="-1" class="icon bowtie-icon" aria-hidden="true" *ngIf="child.canExpandAll"
                    (click)="child.isExpanded? child.closeAll() : child.toggleAll(); $event.stopPropagation()"
                    [ngClass]="{ 'bowtie-math-plus-heavy': child.isCollapsed, 'bowtie-math-minus': child.isExpanded }"
                    [title]="child.isCollapsed ? 'Expand All' : 'Collapse All'"> x
                    </span>
                    <img *ngIf="child.badge && child.badge() && child.badge().badgeClass && child.badge().badgeClass !== 'badge-ok'"
                            class="tree-badge" [title]="child.badge().text"
                            [src]="'assets/' + child.badge().badgeClass + '.svg'" role="presentation">
                    <span class="tree-label" [innerHTML]="child.displayHtml"  [title]="child.displayName()"></span>
                    
                    <div *ngIf="child.actions && child.actions.length > 0" class="hidden right-action">
                        <app-action-collection-drop-down [actionCollection]="child.actions" [treeView]="true"></app-action-collection-drop-down>
                    </div>
                </div>
        
            <app-tree-node [node]="child.childGroupViewModel" *ngIf="child.isVisibleByBadge"></app-tree-node>
        </li>
</div>
